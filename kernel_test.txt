Example session for computing MF kernels
========================================

LIB "homolog.lib";
LIB "linalg.lib";
LIB "dualitytrace.lib";
ring S = 0,(x,y),ds;
ideal I = xy;
qring A = std(I);

// The matrix Q we are going to define is d^1 for a matrix factorisation J_2 \otimes X \otimes Y where X is the MF (0,

matrix phi_x[4][4] = 0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0;
matrix phi_y[4][4] = 0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0;
matrix phi_xy[4][4] = 0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
matrix E[4][4]; E = E+1;
matrix zero[4][4];
matrix block_1[8][8] = blockmat(x * E, phi_y, x * E - phi_x, phi_y - y * E);
matrix block_2[8][8] = blockmat(phi_x,zero,zero,phi_x);
matrix block_3[8][8] = blockmat(phi_y,zero,zero,phi_y);
matrix block_4[8][8] = blockmat(phi_y - y * E, - phi_y, phi_x - x * E, x * E);
matrix Q[16][16] = blockmat(block_1,block_2,block_3,block_4);

// Get the row reduced form, then remove all columns with only one 1 and all else zero
// list L = rowred(Q,1);
// matrix F[16][16] = rm_unitcol(L[1]);

//  Let us calculate the dimension of the stable endomorphism ring of this thing
module M = module(Q);
isCM(M);
list l = Ext(2,M,M,1);

// The answer should be 8 dimensional. So it is probably X + X + Y + Y where X,Y are the unique indecomposable MFs of xy.